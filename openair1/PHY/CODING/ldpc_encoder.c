#include <stdlib.h>
#include <math.h>
#include <stdio.h>
#include <string.h>
#include "Gen_shift_value.h"

short *choose_generator_matrix(short BG,short Zc)
{
  short *Gen_shift_values;

  if (BG==1)
  {
    switch (Zc)
    {
      case 2: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_2;
        break;

      case 3: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_3;
        break;

      case 4: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_4;
        break;

      case 5: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_5;
        break;

      case 6: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_6;
        break;

      case 7: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_7;
        break;

      case 8: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_8;
        break;

      case 9: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_9;
        break;

      case 10: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_10;
        break;

      case 11: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_11;
        break;

      case 12: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_12;
        break;

      case 13: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_13;
        break;

      case 14: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_14;
        break;

      case 15: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_15;
        break;

      case 16: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_16;
        break;

      case 18: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_18;
        break;

      case 20: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_20;
        break;

      case 22: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_22;
        break;

      case 24: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_24;
        break;

      case 26: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_26;
        break;

      case 28: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_28;
        break;

      case 30: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_30;
        break;

      case 32: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_32;
        break;

      case 36: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_36;
        break;

      case 40: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_40;
        break;

      case 44: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_44;
        break;

      case 48: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_48;
        break;

      case 52: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_52;
        break;

      case 56: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_56;
        break;

      case 60: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_60;
        break;

      case 64: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_64;
        break;

      case 72: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_72;
        break;

      case 80: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_80;
        break;

      case 88: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_88;
        break;

      case 96: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_96;
        break;

      case 104: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_104;
        break;

      case 112: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_112;
        break;

      case 120: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_120;
        break;

      case 128: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_128;
        break;

      case 144: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_144;
        break;

      case 160: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_160;
        break;

      case 176: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_176;
        break;

      case 192: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_192;
        break;

      case 208: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_208;
        break;

      case 224: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_224;
        break;

      case 240: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_240;
        break;

      case 256: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_256;
        break;

      case 288: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_288;
        break;

      case 320: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_320;
        break;

      case 352: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_352;
        break;

      case 384: Gen_shift_values=(short *) Gen_shift_values_BG1_Z_384;
        break;
    }
  }
  else if (BG==2)
  {
    switch (Zc)
    {
      case 2: Gen_shift_values=(short *) Gen_shift_values_BG2_Z_2;
        break;

        /*
                    case 3: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_3;
                        break;
                    case 4: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_4;
                        break;
                    case 5: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_5;
                        break;
                    case 6: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_6;
                        break;
                    case 7: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_7;
                        break;
                    case 8: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_8;
                        break;
                    case 9: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_9;
                        break;
                    case 10: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_10;
                        break;
                    case 11: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_11;
                        break;
                    case 12: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_12;
                        break;
                    case 13: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_13;
                        break;
                    case 14: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_14;
                        break;
                    case 15: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_15;
                        break;
                    case 16: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_16;
                        break;
                    case 18: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_18;
                        break;
                    case 20: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_20;
                        break;
                    case 22: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_22;
                        break;
                    case 24: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_24;
                        break;
                    case 26: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_26;
                        break;
                    case 28: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_28;
                        break;
                    case 30: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_30;
                        break;
                    case 32: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_32;
                        break;
                    case 36: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_36;
                        break;
                    case 40: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_40;
                        break;
                    case 44: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_44;
                        break;
                    case 48: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_48;
                        break;
                    case 52: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_52;
                        break;
                    case 56: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_56;
                        break;
                    case 60: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_60;
                        break;
                    case 64: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_64;
                        break;
                    case 72: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_72;
                        break;
                    case 80: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_80;
                        break;
                    case 88: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_88;
                        break;
                    case 96: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_96;
                        break;
                    case 104: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_104;
                        break;
                    case 112: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_112;
                        break;
                    case 120: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_120;
                        break;
                    */
      case 128: Gen_shift_values=(short *) Gen_shift_values_BG2_Z_128;
        break;
        /*
        case 144: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_144;
            break;
        case 160: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_160;
            break;
        case 176: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_176;
            break;
        case 192: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_192;
            break;
        case 208: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_208;
            break;
        case 224: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_224;
            break;
        case 240: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_240;
            break;
        case 256: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_256;
            break;
        case 288: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_288;
            break;
        case 320: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_320;
            break;
        case 352: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_352;
            break;
        case 384: Gen_shift_values=(short*) Gen_shift_values_BG2_Z_384;
            break;
        */
    }
  }

  return Gen_shift_values;
}

int ldpc_encoder(unsigned char *test_input,unsigned char *channel_input,short block_length,double rate)
{
  unsigned char c[22*384]; //padded input, unpacked, max size
  unsigned char d[68*384]; //coded output, unpacked, max size
  unsigned char channel_temp,temp;
  short *Gen_shift_values, *no_shift_values, *pointer_shift_values;
  short BG,Zc,Kb,nrows,ncols;
  int i,i1,i2,i3,i4,i5,t,t1,temp_prime;
  int no_punctured_columns,removed_bit;
  //Table of possible lifting sizes
  short lift_size[51]= {2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,20,22,24,26,28,30,32,36,40,44,48,52,56,60,64,72,80,88,96,104,112,120,128,144,160,176,192,208,224,240,256,288,320,352,384};
  //determine number of bits in codeword
  //if (block_length>3840)
  //{
  BG=1;
  Kb = 22;
  nrows=46; //parity check bits
  ncols=22; //info bits
  //}
  /* else if (block_length<=3840)
  {
    BG=2;
    nrows=42; //parity check bits
    ncols=10; // info bits

    if (block_length>640)
      Kb = 10;
    else if (block_length>560)
      Kb = 9;
    else if (block_length>192)
      Kb = 8;
    else
      Kb = 6;
  } */

  //find minimum value in all sets of lifting size
  Zc=0;
  for (i1=0; i1 < 51; i1++)
  {
    if (lift_size[i1] >= (double) block_length/Kb)
    {
      Zc = lift_size[i1];
      //printf("%d\n",Zc);
      break;
    }
  }
  if (Zc==0) {
    printf("ldpc_encoder: no lift_size found, problem in block_length %d\n",block_length);
    return(-1);
  }


  // load base graph of generator matrix
  /*  if (BG==1)
   {
     no_shift_values=(short *) no_shift_values_BG1;
     pointer_shift_values=(short *) pointer_shift_values_BG1;
   }
   else if (BG==2)
   {
     no_shift_values=(short *) no_shift_values_BG2;
     pointer_shift_values=(short *) pointer_shift_values_BG2;
   } */
  //Gen_shift_values=choose_generator_matrix(BG,Zc);
  // calculate number of punctured bits
  no_punctured_columns=(int)((nrows-2)*Zc+block_length-block_length/rate)/Zc;
  removed_bit=(nrows-no_punctured_columns-2) * Zc+block_length-(int)(block_length/rate);
  //printf("%d\n",no_punctured_columns);
  //printf("%d\n",removed_bit);
  // unpack input
  memset(c,0,sizeof(unsigned char) * Kb * Zc);

  for (i=0; i<block_length; i++)
  {
    //c[i] = test_input[i/8]<<(i%8);
    //c[i]=c[i]>>7&1;
    c[i]=(test_input[i/8]&(1<<(i&7)))>>(i&7); //LSB first
  }

  // parity check part
  if (BG==1)
  {
    if (Zc==128)
    {
      for (i2=0; i2 < Zc; i2++)
      {
        t=Kb*Zc+i2;

        //rotate matrix here
        for (i5=0; i5 < Kb; i5++)
        {
          temp = c[i5*Zc];
          memmove(&c[i5*Zc], &c[i5*Zc+1], (Zc-1)*sizeof(unsigned char));
          c[i5*Zc+Zc-1] = temp;
        }

        // calculate each row in base graph
        //row: 0
        d[t+0*Zc]=c[121]^c[1]^c[105]^c[120]^c[196]^c[238]^c[216]^c[353]^c[366]^c[312]^c[414]^c[500]^c[467]^c[635]^c[574]^c[531]^c[739]^c[710]^c[756]^c[777]^c[860]^c[789]^c[989]^c[996]^c[898]^c[1127]^c[1072]^c[1138]^c[1210]^c[1196]^c[1246]^c[1380]^c[1318]^c[1287]^c[1517]^c[1499]^c[1493]^c[1598]^c[1637]^c[1653]^c[1672]^c[1677]^c[1754]^c[1900]^c[1888]^c[1874]^c[1986]^c[1923]^c[2016]^c[2070]^c[2061]^c[2159]^c[2202]^c[2292]^c[2251]^c[2365]^c[2380]^c[2419]^c[2466]^c[2558]^c[2554]^c[2670]^c[2676]^c[2575]^c[2718]^c[2715]^c[2699];
        //row: 1
        d[t+1*Zc]=c[121]^c[122]^c[2]^c[106]^c[121]^c[196]^c[197]^c[239]^c[217]^c[353]^c[354]^c[367]^c[313]^c[414]^c[415]^c[501]^c[468]^c[636]^c[575]^c[532]^c[739]^c[740]^c[711]^c[757]^c[777]^c[778]^c[861]^c[790]^c[990]^c[997]^c[899]^c[1128]^c[1073]^c[1139]^c[1210]^c[1211]^c[1197]^c[1247]^c[1380]^c[1381]^c[1319]^c[1288]^c[1517]^c[1518]^c[1500]^c[1494]^c[1598]^c[1599]^c[1638]^c[1654]^c[1672]^c[1673]^c[1678]^c[1755]^c[1901]^c[1889]^c[1875]^c[1986]^c[1987]^c[1924]^c[2017]^c[2070]^c[2071]^c[2062]^c[2160]^c[2203]^c[2293]^c[2252]^c[2365]^c[2366]^c[2381]^c[2420]^c[2466]^c[2467]^c[2559]^c[2555]^c[2670]^c[2671]^c[2677]^c[2576]^c[2718]^c[2719]^c[2716]^c[2700];
        //row: 2
        d[t+2*Zc]=c[122]^c[2]^c[105]^c[106]^c[120]^c[121]^c[197]^c[238]^c[239]^c[216]^c[217]^c[354]^c[367]^c[312]^c[313]^c[415]^c[501]^c[467]^c[468]^c[636]^c[574]^c[575]^c[531]^c[532]^c[740]^c[711]^c[756]^c[757]^c[778]^c[860]^c[861]^c[789]^c[790]^c[990]^c[996]^c[997]^c[898]^c[899]^c[1128]^c[1072]^c[1073]^c[1138]^c[1139]^c[1211]^c[1197]^c[1246]^c[1247]^c[1381]^c[1318]^c[1319]^c[1287]^c[1288]^c[1518]^c[1500]^c[1493]^c[1494]^c[1599]^c[1638]^c[1653]^c[1654]^c[1673]^c[1677]^c[1678]^c[1754]^c[1755]^c[1901]^c[1888]^c[1889]^c[1874]^c[1875]^c[1987]^c[1924]^c[2016]^c[2017]^c[2071]^c[2062]^c[2159]^c[2160]^c[2203]^c[2292]^c[2293]^c[2251]^c[2252]^c[2366]^c[2380]^c[2381]^c[2419]^c[2420]^c[2467]^c[2559]^c[2554]^c[2555]^c[2671]^c[2676]^c[2677]^c[2575]^c[2576]^c[2719]^c[2716]^c[2699]^c[2700];
        //row: 3
        d[t+3*Zc]=c[122]^c[2]^c[106]^c[120]^c[121]^c[197]^c[239]^c[216]^c[217]^c[354]^c[367]^c[313]^c[415]^c[501]^c[467]^c[468]^c[636]^c[575]^c[531]^c[532]^c[740]^c[711]^c[757]^c[778]^c[861]^c[789]^c[790]^c[990]^c[997]^c[898]^c[899]^c[1128]^c[1073]^c[1138]^c[1139]^c[1211]^c[1197]^c[1247]^c[1381]^c[1319]^c[1287]^c[1288]^c[1518]^c[1500]^c[1493]^c[1494]^c[1599]^c[1638]^c[1653]^c[1654]^c[1673]^c[1678]^c[1754]^c[1755]^c[1901]^c[1889]^c[1874]^c[1875]^c[1987]^c[1924]^c[2017]^c[2071]^c[2062]^c[2159]^c[2160]^c[2203]^c[2293]^c[2251]^c[2252]^c[2366]^c[2381]^c[2419]^c[2420]^c[2467]^c[2559]^c[2555]^c[2671]^c[2677]^c[2575]^c[2576]^c[2719]^c[2716]^c[2699]^c[2700];
        //row: 4
        d[t+4*Zc]=c[28]^c[229];
        //row: 5
        d[t+5*Zc]=c[108]^c[116]^c[92]^c[107]^c[76]^c[183]^c[225]^c[203]^c[235]^c[340]^c[353]^c[299]^c[401]^c[487]^c[454]^c[449]^c[622]^c[561]^c[518]^c[726]^c[697]^c[743]^c[892]^c[847]^c[776]^c[976]^c[983]^c[1013]^c[1114]^c[1059]^c[1125]^c[1197]^c[1183]^c[1233]^c[1367]^c[1305]^c[1402]^c[1504]^c[1486]^c[1480]^c[1585]^c[1624]^c[1640]^c[1638]^c[1787]^c[1664]^c[1741]^c[1887]^c[1875]^c[1861]^c[1973]^c[2038]^c[2003]^c[2057]^c[2048]^c[2146]^c[2075]^c[2189]^c[2279]^c[2238]^c[2352]^c[2367]^c[2406]^c[2453]^c[2545]^c[2541]^c[2657]^c[2663]^c[2562]^c[2705]^c[2702]^c[2814]^c[2810];
        //row: 6
        d[t+6*Zc]=c[54]^c[789]^c[1307]^c[1474]^c[1779]^c[2186]^c[2332]^c[2642];
        //row: 7
        d[t+7*Zc]=c[91]^c[171]^c[542]^c[926]^c[1062]^c[1895];
        //row: 8
        d[t+8*Zc]=c[106]^c[84]^c[114]^c[92]^c[90]^c[67]^c[68]^c[105]^c[82]^c[83]^c[111]^c[181]^c[159]^c[223]^c[200]^c[201]^c[201]^c[178]^c[179]^c[131]^c[338]^c[316]^c[351]^c[329]^c[297]^c[274]^c[275]^c[399]^c[505]^c[485]^c[463]^c[452]^c[429]^c[430]^c[390]^c[620]^c[598]^c[559]^c[536]^c[537]^c[516]^c[621]^c[622]^c[724]^c[702]^c[695]^c[673]^c[741]^c[718]^c[719]^c[890]^c[868]^c[845]^c[822]^c[823]^c[774]^c[879]^c[880]^c[974]^c[952]^c[981]^c[958]^c[959]^c[1011]^c[988]^c[989]^c[1112]^c[1090]^c[1057]^c[1034]^c[1035]^c[1123]^c[1100]^c[1101]^c[1195]^c[1173]^c[1181]^c[1159]^c[1231]^c[1208]^c[1209]^c[1365]^c[1343]^c[1303]^c[1280]^c[1281]^c[1400]^c[1377]^c[1378]^c[1502]^c[1480]^c[1484]^c[1462]^c[1478]^c[1455]^c[1456]^c[1583]^c[1561]^c[1622]^c[1600]^c[1638]^c[1615]^c[1616]^c[1618]^c[1785]^c[1763]^c[1790]^c[1767]^c[1768]^c[1739]^c[1716]^c[1717]^c[1885]^c[1863]^c[1873]^c[1850]^c[1851]^c[1859]^c[1836]^c[1837]^c[1971]^c[1949]^c[2036]^c[2014]^c[2001]^c[1978]^c[1979]^c[2055]^c[2161]^c[2174]^c[2152]^c[2144]^c[2121]^c[2122]^c[2149]^c[2187]^c[2293]^c[2277]^c[2254]^c[2255]^c[2236]^c[2213]^c[2214]^c[2350]^c[2328]^c[2365]^c[2342]^c[2343]^c[2404]^c[2381]^c[2382]^c[2451]^c[2557]^c[2543]^c[2521]^c[2539]^c[2516]^c[2517]^c[2467]^c[2655]^c[2633]^c[2661]^c[2638]^c[2639]^c[2560]^c[2665]^c[2666]^c[2703]^c[2809]^c[2700]^c[2806]^c[2812]^c[2789]^c[2790]^c[2796];
        //row: 9
        d[t+9*Zc]=c[102]^c[181]^c[1388]^c[1428]^c[1677]^c[2189]^c[2364]^c[2647];
        //row: 10
        d[t+10*Zc]=c[225]^c[276]^c[550]^c[927]^c[1072]^c[1849];
        //row: 11
        d[t+11*Zc]=c[117]^c[15]^c[16]^c[125]^c[24]^c[101]^c[0]^c[116]^c[15]^c[76]^c[192]^c[218]^c[219]^c[234]^c[133]^c[212]^c[239]^c[168]^c[349]^c[375]^c[376]^c[362]^c[261]^c[308]^c[335]^c[410]^c[436]^c[437]^c[496]^c[395]^c[463]^c[490]^c[631]^c[530]^c[570]^c[597]^c[527]^c[554]^c[735]^c[761]^c[762]^c[706]^c[733]^c[752]^c[651]^c[773]^c[799]^c[800]^c[856]^c[883]^c[785]^c[812]^c[985]^c[1012]^c[992]^c[1019]^c[1022]^c[921]^c[1123]^c[1150]^c[1068]^c[1095]^c[1134]^c[1033]^c[1206]^c[1232]^c[1233]^c[1192]^c[1219]^c[1242]^c[1269]^c[1376]^c[1402]^c[1403]^c[1314]^c[1341]^c[1283]^c[1310]^c[1513]^c[1411]^c[1412]^c[1495]^c[1522]^c[1489]^c[1516]^c[1594]^c[1620]^c[1621]^c[1633]^c[1660]^c[1649]^c[1548]^c[1618]^c[1668]^c[1694]^c[1695]^c[1673]^c[1700]^c[1750]^c[1777]^c[1896]^c[1795]^c[1884]^c[1911]^c[1870]^c[1897]^c[1982]^c[2008]^c[2009]^c[2047]^c[1946]^c[2012]^c[2039]^c[2066]^c[2092]^c[2093]^c[2057]^c[2084]^c[2155]^c[2054]^c[2101]^c[2198]^c[2225]^c[2288]^c[2187]^c[2247]^c[2274]^c[2361]^c[2387]^c[2388]^c[2376]^c[2403]^c[2415]^c[2314]^c[2462]^c[2488]^c[2489]^c[2554]^c[2453]^c[2550]^c[2449]^c[2666]^c[2564]^c[2565]^c[2672]^c[2571]^c[2571]^c[2598]^c[2714]^c[2740]^c[2741]^c[2711]^c[2738]^c[2695]^c[2722]^c[2765];
        //row: 12
        d[t+12*Zc]=c[31]^c[169]^c[1300]^c[1439]^c[1769]^c[2310];
        //row: 13
        d[t+13*Zc]=c[55]^c[56]^c[64]^c[40]^c[55]^c[48]^c[130]^c[131]^c[173]^c[151]^c[287]^c[288]^c[301]^c[375]^c[476]^c[477]^c[435]^c[402]^c[503]^c[570]^c[637]^c[594]^c[673]^c[674]^c[645]^c[691]^c[839]^c[840]^c[795]^c[852]^c[924]^c[931]^c[961]^c[918]^c[1062]^c[1135]^c[1073]^c[1272]^c[1273]^c[1259]^c[1181]^c[1314]^c[1315]^c[1381]^c[1350]^c[1451]^c[1452]^c[1434]^c[1428]^c[1660]^c[1661]^c[1572]^c[1588]^c[1734]^c[1735]^c[1740]^c[1689]^c[1835]^c[1823]^c[1809]^c[1920]^c[1921]^c[1986]^c[1951]^c[2132]^c[2133]^c[2124]^c[2094]^c[2265]^c[2227]^c[2186]^c[2427]^c[2428]^c[2315]^c[2354]^c[2528]^c[2529]^c[2493]^c[2489]^c[2604]^c[2605]^c[2611]^c[2638]^c[2616]^c[2780]^c[2781]^c[2778]^c[2762];
        //row: 14
        d[t+14*Zc]=c[77]^c[1590]^c[1997]^c[2174]^c[2191]^c[2788];
        //row: 15
        d[t+15*Zc]=c[45]^c[53]^c[29]^c[43]^c[44]^c[39]^c[248]^c[162]^c[139]^c[140]^c[223]^c[277]^c[290]^c[364]^c[466]^c[424]^c[390]^c[391]^c[559]^c[626]^c[582]^c[583]^c[663]^c[762]^c[680]^c[829]^c[784]^c[840]^c[841]^c[913]^c[920]^c[949]^c[950]^c[1051]^c[1124]^c[1061]^c[1062]^c[1262]^c[1248]^c[1170]^c[1304]^c[1370]^c[1338]^c[1339]^c[1344]^c[1441]^c[1423]^c[1416]^c[1417]^c[1650]^c[1561]^c[1576]^c[1577]^c[1724]^c[1729]^c[1677]^c[1678]^c[1726]^c[1824]^c[1812]^c[1797]^c[1798]^c[2038]^c[1975]^c[1940]^c[2122]^c[2113]^c[2082]^c[2083]^c[2254]^c[2216]^c[2302]^c[2303]^c[2417]^c[2304]^c[2342]^c[2343]^c[2378]^c[2518]^c[2482]^c[2478]^c[2594]^c[2600]^c[2626]^c[2627]^c[2770]^c[2767]^c[2750]^c[2751];
        //row: 16
        d[t+16*Zc]=c[19]^c[27]^c[3]^c[18]^c[222]^c[136]^c[242]^c[191]^c[379]^c[264]^c[338]^c[440]^c[398]^c[493]^c[432]^c[533]^c[600]^c[557]^c[765]^c[736]^c[654]^c[803]^c[886]^c[815]^c[1015]^c[1022]^c[924]^c[1025]^c[1098]^c[1036]^c[1236]^c[1222]^c[1272]^c[1406]^c[1344]^c[1313]^c[1415]^c[1525]^c[1519]^c[1456]^c[1624]^c[1663]^c[1551]^c[1698]^c[1703]^c[1780]^c[1798]^c[1914]^c[1900]^c[2012]^c[1949]^c[2042]^c[2096]^c[2087]^c[2057]^c[2228]^c[2190]^c[2277]^c[2391]^c[2406]^c[2317]^c[2492]^c[2456]^c[2452]^c[2568]^c[2574]^c[2601]^c[2610]^c[2744]^c[2741]^c[2725];
        //row: 17
        d[t+17*Zc]=c[6]^c[1827]^c[2106]^c[2176]^c[2703];
        //row: 18
        d[t+18*Zc]=c[169]^c[1640]^c[1671]^c[2330]^c[2450];
        //row: 19
        d[t+19*Zc]=c[59]^c[200]^c[967]^c[1150]^c[1375];
        //row: 20
        d[t+20*Zc]=c[25]^c[33]^c[9]^c[24]^c[22]^c[228]^c[142]^c[248]^c[257]^c[270]^c[344]^c[446]^c[404]^c[499]^c[441]^c[539]^c[606]^c[563]^c[643]^c[742]^c[660]^c[809]^c[892]^c[821]^c[1021]^c[900]^c[930]^c[1031]^c[1104]^c[1042]^c[1242]^c[1228]^c[1278]^c[1240]^c[1284]^c[1350]^c[1319]^c[1421]^c[1531]^c[1525]^c[1454]^c[1630]^c[1541]^c[1557]^c[1704]^c[1709]^c[1786]^c[1804]^c[1792]^c[1906]^c[2018]^c[1955]^c[1920]^c[2102]^c[2093]^c[2063]^c[2234]^c[2196]^c[2283]^c[2397]^c[2412]^c[2323]^c[2498]^c[2462]^c[2458]^c[2574]^c[2580]^c[2607]^c[2750]^c[2747]^c[2731];
        //row: 21
        d[t+21*Zc]=c[248]^c[760]^c[2156]^c[2562]^c[2730];
        //row: 22
        d[t+22*Zc]=c[63]^c[1549]^c[1723]^c[2205];
        //row: 23
        d[t+23*Zc]=c[155]^c[274]^c[1321]^c[2327];
        //row: 24
        d[t+24*Zc]=c[87]^c[95]^c[71]^c[86]^c[111]^c[162]^c[204]^c[182]^c[319]^c[332]^c[278]^c[508]^c[466]^c[433]^c[469]^c[601]^c[540]^c[625]^c[619]^c[705]^c[676]^c[722]^c[871]^c[826]^c[883]^c[955]^c[962]^c[992]^c[1093]^c[1038]^c[1104]^c[1176]^c[1162]^c[1212]^c[1346]^c[1284]^c[1381]^c[1483]^c[1465]^c[1459]^c[1523]^c[1564]^c[1603]^c[1619]^c[1766]^c[1771]^c[1720]^c[1866]^c[1854]^c[1840]^c[1952]^c[2017]^c[1982]^c[2164]^c[2155]^c[2125]^c[2296]^c[2258]^c[2217]^c[2331]^c[2346]^c[2385]^c[2432]^c[2524]^c[2520]^c[2636]^c[2642]^c[2669]^c[2812]^c[2809]^c[2793];
        //row: 25
        d[t+25*Zc]=c[150]^c[775]^c[1011]^c[1845];
        //row: 26
        d[t+26*Zc]=c[66]^c[370]^c[598]^c[1980];
        //row: 27
        d[t+27*Zc]=c[152]^c[871]^c[1089];
        //row: 28
        d[t+28*Zc]=c[127]^c[548]^c[2484]^c[2750];
        //row: 29
        d[t+29*Zc]=c[0]^c[8]^c[112]^c[126]^c[127]^c[203]^c[245]^c[222]^c[223]^c[213]^c[360]^c[373]^c[319]^c[421]^c[507]^c[473]^c[474]^c[514]^c[581]^c[537]^c[538]^c[746]^c[717]^c[763]^c[784]^c[867]^c[795]^c[796]^c[996]^c[1003]^c[904]^c[905]^c[1134]^c[1079]^c[1144]^c[1145]^c[1217]^c[1203]^c[1253]^c[1387]^c[1325]^c[1293]^c[1294]^c[1524]^c[1506]^c[1499]^c[1500]^c[1605]^c[1644]^c[1659]^c[1660]^c[1679]^c[1684]^c[1760]^c[1761]^c[1907]^c[1895]^c[1880]^c[1881]^c[1899]^c[1993]^c[1930]^c[2023]^c[2077]^c[2068]^c[2165]^c[2166]^c[2209]^c[2299]^c[2257]^c[2258]^c[2372]^c[2387]^c[2425]^c[2426]^c[2387]^c[2473]^c[2437]^c[2433]^c[2677]^c[2683]^c[2581]^c[2582]^c[2725]^c[2722]^c[2705]^c[2706];
        //row: 30
        d[t+30*Zc]=c[3]^c[11]^c[114]^c[115]^c[1]^c[2]^c[87]^c[206]^c[247]^c[248]^c[225]^c[226]^c[363]^c[376]^c[321]^c[322]^c[424]^c[510]^c[476]^c[477]^c[517]^c[583]^c[584]^c[540]^c[541]^c[749]^c[720]^c[765]^c[766]^c[787]^c[869]^c[870]^c[798]^c[799]^c[999]^c[1005]^c[1006]^c[907]^c[908]^c[1137]^c[1081]^c[1082]^c[1147]^c[1148]^c[1220]^c[1206]^c[1255]^c[1256]^c[1390]^c[1327]^c[1328]^c[1296]^c[1297]^c[1352]^c[1527]^c[1509]^c[1502]^c[1503]^c[1608]^c[1647]^c[1662]^c[1663]^c[1682]^c[1686]^c[1687]^c[1763]^c[1764]^c[1783]^c[1910]^c[1897]^c[1898]^c[1883]^c[1884]^c[1996]^c[1933]^c[2025]^c[2026]^c[2080]^c[2071]^c[2168]^c[2169]^c[2212]^c[2301]^c[2302]^c[2260]^c[2261]^c[2375]^c[2389]^c[2390]^c[2428]^c[2429]^c[2476]^c[2440]^c[2435]^c[2436]^c[2680]^c[2685]^c[2686]^c[2584]^c[2585]^c[2728]^c[2725]^c[2708]^c[2709];
        //row: 31
        d[t+31*Zc]=c[37]^c[55]^c[45]^c[63]^c[21]^c[39]^c[36]^c[53]^c[54]^c[240]^c[130]^c[154]^c[172]^c[132]^c[149]^c[150]^c[222]^c[269]^c[287]^c[282]^c[300]^c[356]^c[374]^c[458]^c[476]^c[416]^c[434]^c[511]^c[400]^c[401]^c[551]^c[569]^c[618]^c[636]^c[575]^c[592]^c[593]^c[655]^c[673]^c[754]^c[644]^c[672]^c[690]^c[821]^c[839]^c[776]^c[794]^c[833]^c[850]^c[851]^c[905]^c[923]^c[912]^c[930]^c[942]^c[959]^c[960]^c[944]^c[1043]^c[1061]^c[1116]^c[1134]^c[1054]^c[1071]^c[1072]^c[1254]^c[1272]^c[1240]^c[1258]^c[1162]^c[1180]^c[1296]^c[1314]^c[1362]^c[1380]^c[1331]^c[1348]^c[1349]^c[1433]^c[1451]^c[1415]^c[1433]^c[1409]^c[1426]^c[1427]^c[1642]^c[1660]^c[1553]^c[1571]^c[1569]^c[1586]^c[1587]^c[1716]^c[1734]^c[1721]^c[1739]^c[1670]^c[1687]^c[1688]^c[1816]^c[1834]^c[1804]^c[1822]^c[1918]^c[1807]^c[1808]^c[2030]^c[1920]^c[1967]^c[1985]^c[1932]^c[1950]^c[2114]^c[2132]^c[2105]^c[2123]^c[2075]^c[2092]^c[2093]^c[2246]^c[2264]^c[2208]^c[2226]^c[2295]^c[2184]^c[2185]^c[2409]^c[2427]^c[2424]^c[2314]^c[2335]^c[2352]^c[2353]^c[2510]^c[2528]^c[2474]^c[2492]^c[2470]^c[2488]^c[2586]^c[2604]^c[2592]^c[2610]^c[2619]^c[2636]^c[2637]^c[2762]^c[2780]^c[2759]^c[2777]^c[2743]^c[2760]^c[2761];
        //row: 32
        d[t+32*Zc]=c[115]^c[123]^c[98]^c[99]^c[113]^c[114]^c[92]^c[190]^c[231]^c[232]^c[209]^c[210]^c[347]^c[360]^c[305]^c[306]^c[408]^c[494]^c[460]^c[461]^c[629]^c[567]^c[568]^c[524]^c[525]^c[733]^c[704]^c[749]^c[750]^c[771]^c[853]^c[854]^c[782]^c[783]^c[983]^c[989]^c[990]^c[1019]^c[1020]^c[1121]^c[1065]^c[1066]^c[1131]^c[1132]^c[1204]^c[1190]^c[1239]^c[1240]^c[1374]^c[1311]^c[1312]^c[1280]^c[1281]^c[1511]^c[1493]^c[1486]^c[1487]^c[1592]^c[1631]^c[1646]^c[1647]^c[1647]^c[1666]^c[1670]^c[1671]^c[1747]^c[1748]^c[1894]^c[1881]^c[1882]^c[1867]^c[1868]^c[1862]^c[1980]^c[2045]^c[2009]^c[2010]^c[2064]^c[2055]^c[2152]^c[2153]^c[2196]^c[2285]^c[2286]^c[2244]^c[2245]^c[2359]^c[2373]^c[2374]^c[2412]^c[2413]^c[2460]^c[2552]^c[2547]^c[2548]^c[2664]^c[2669]^c[2670]^c[2568]^c[2569]^c[2712]^c[2709]^c[2692]^c[2693];
        //row: 33
        d[t+33*Zc]=c[129]^c[314]^c[1448]^c[2770];
        //row: 34
        d[t+34*Zc]=c[126]^c[934]^c[1955]^c[2206];
        //row: 35
        d[t+35*Zc]=c[96]^c[104]^c[80]^c[95]^c[171]^c[213]^c[191]^c[160]^c[328]^c[341]^c[287]^c[389]^c[475]^c[442]^c[610]^c[549]^c[634]^c[714]^c[685]^c[731]^c[880]^c[835]^c[892]^c[836]^c[964]^c[971]^c[1001]^c[1102]^c[1047]^c[1113]^c[1185]^c[1171]^c[1221]^c[1355]^c[1293]^c[1390]^c[1492]^c[1474]^c[1468]^c[1573]^c[1612]^c[1628]^c[1614]^c[1775]^c[1780]^c[1729]^c[1875]^c[1863]^c[1849]^c[1961]^c[2026]^c[1991]^c[2173]^c[2164]^c[2134]^c[2177]^c[2267]^c[2226]^c[2340]^c[2355]^c[2394]^c[2441]^c[2533]^c[2529]^c[2645]^c[2651]^c[2678]^c[2693]^c[2690]^c[2802];
        //row: 36
        d[t+36*Zc]=c[36]^c[1896]^c[1970]^c[2423];
        //row: 37
        d[t+37*Zc]=c[115]^c[116]^c[124]^c[100]^c[115]^c[190]^c[191]^c[233]^c[211]^c[197]^c[347]^c[348]^c[361]^c[307]^c[408]^c[409]^c[495]^c[462]^c[630]^c[569]^c[526]^c[733]^c[734]^c[705]^c[751]^c[771]^c[772]^c[855]^c[784]^c[984]^c[991]^c[1021]^c[1122]^c[1067]^c[1133]^c[1204]^c[1205]^c[1191]^c[1241]^c[1374]^c[1375]^c[1313]^c[1282]^c[1511]^c[1512]^c[1494]^c[1488]^c[1592]^c[1593]^c[1632]^c[1648]^c[1666]^c[1667]^c[1672]^c[1749]^c[1755]^c[1895]^c[1883]^c[1869]^c[1980]^c[1981]^c[2046]^c[2011]^c[2064]^c[2065]^c[2056]^c[2154]^c[2197]^c[2287]^c[2246]^c[2359]^c[2360]^c[2375]^c[2414]^c[2460]^c[2461]^c[2553]^c[2549]^c[2664]^c[2665]^c[2671]^c[2570]^c[2712]^c[2713]^c[2710]^c[2694];
        //row: 38
        d[t+38*Zc]=c[38]^c[1174]^c[1308]^c[1570];
        //row: 39
        d[t+39*Zc]=c[172]^c[394]^c[916]^c[2559];
        //row: 40
        d[t+40*Zc]=c[28]^c[1032]^c[2196];
        //row: 41
        d[t+41*Zc]=c[166]^c[428]^c[1162]^c[2326];
        //row: 42
        d[t+42*Zc]=c[3]^c[11]^c[114]^c[115]^c[1]^c[2]^c[20]^c[206]^c[247]^c[248]^c[225]^c[226]^c[363]^c[376]^c[321]^c[322]^c[424]^c[510]^c[476]^c[477]^c[517]^c[583]^c[584]^c[540]^c[541]^c[540]^c[749]^c[720]^c[765]^c[766]^c[787]^c[869]^c[870]^c[798]^c[799]^c[999]^c[1005]^c[1006]^c[907]^c[908]^c[1137]^c[1081]^c[1082]^c[1147]^c[1148]^c[1220]^c[1206]^c[1255]^c[1256]^c[1390]^c[1327]^c[1328]^c[1296]^c[1297]^c[1527]^c[1509]^c[1502]^c[1503]^c[1608]^c[1647]^c[1662]^c[1663]^c[1682]^c[1686]^c[1687]^c[1763]^c[1764]^c[1910]^c[1897]^c[1898]^c[1883]^c[1884]^c[1996]^c[1933]^c[2025]^c[2026]^c[2080]^c[2071]^c[2168]^c[2169]^c[2212]^c[2301]^c[2302]^c[2260]^c[2261]^c[2375]^c[2389]^c[2390]^c[2428]^c[2429]^c[2476]^c[2440]^c[2435]^c[2436]^c[2680]^c[2685]^c[2686]^c[2584]^c[2585]^c[2728]^c[2725]^c[2708]^c[2709];
        //row: 43
        d[t+43*Zc]=c[5]^c[13]^c[117]^c[3]^c[4]^c[208]^c[250]^c[227]^c[228]^c[150]^c[365]^c[378]^c[324]^c[426]^c[384]^c[478]^c[479]^c[519]^c[586]^c[542]^c[543]^c[751]^c[722]^c[640]^c[789]^c[872]^c[800]^c[801]^c[1001]^c[1008]^c[909]^c[910]^c[1139]^c[1084]^c[1149]^c[1150]^c[1222]^c[1208]^c[1258]^c[1392]^c[1330]^c[1298]^c[1299]^c[1529]^c[1511]^c[1504]^c[1505]^c[1610]^c[1649]^c[1536]^c[1537]^c[1684]^c[1689]^c[1765]^c[1766]^c[1912]^c[1900]^c[1885]^c[1886]^c[1998]^c[1935]^c[2028]^c[2082]^c[2073]^c[2170]^c[2171]^c[2082]^c[2214]^c[2176]^c[2262]^c[2263]^c[2377]^c[2392]^c[2430]^c[2431]^c[2348]^c[2478]^c[2442]^c[2438]^c[2682]^c[2560]^c[2586]^c[2587]^c[2730]^c[2727]^c[2710]^c[2711];
        //row: 44
        d[t+44*Zc]=c[38]^c[46]^c[22]^c[37]^c[10]^c[241]^c[155]^c[133]^c[270]^c[283]^c[357]^c[459]^c[417]^c[384]^c[552]^c[619]^c[576]^c[656]^c[755]^c[673]^c[822]^c[777]^c[834]^c[906]^c[913]^c[943]^c[924]^c[1044]^c[1117]^c[1055]^c[1255]^c[1241]^c[1163]^c[1186]^c[1297]^c[1363]^c[1332]^c[1434]^c[1416]^c[1410]^c[1643]^c[1554]^c[1570]^c[1717]^c[1722]^c[1671]^c[1817]^c[1805]^c[1919]^c[2031]^c[1968]^c[1933]^c[2115]^c[2106]^c[2076]^c[2247]^c[2209]^c[2296]^c[2410]^c[2425]^c[2336]^c[2511]^c[2475]^c[2471]^c[2587]^c[2593]^c[2620]^c[2763]^c[2760]^c[2744];
        //row: 45
        d[t+45*Zc]=c[148]^c[790]^c[1318];
      }
    }
    else if (Zc==384)
    {
      for (i2=0; i2 < Zc; i2++)
      {
        t=Kb*Zc+i2;

        //rotate matrix here
        for (i5=0; i5 < Kb; i5++)
        {
          temp = c[i5*Zc];
          memmove(&c[i5*Zc], &c[i5*Zc+1], (Zc-1)*sizeof(unsigned char));
          c[i5*Zc+Zc-1] = temp;
        }

        // calculate each row in base graph
        // 0 row
        d[t+0*Zc]=c[306]^c[75]^c[204]^c[275]^c[402]^c[633]^c[470]^c[817]^c[843]^c[1095]^c[1520]^c[1224]^c[1535]^c[1823]^c[1867]^c[1810]^c[2100]^c[2063]^c[2175]^c[2519]^c[2464]^c[2502]^c[3018]^c[2954]^c[2840]^c[3402]^c[3231]^c[3127]^c[3772]^c[3633]^c[3518]^c[4127]^c[3968]^c[3971]^c[4332]^c[4518]^c[4528]^c[4624]^c[4949]^c[4838]^c[5348]^c[5191]^c[5332]^c[5592]^c[5463]^c[5587]^c[5974]^c[5858]^c[5812]^c[6249]^c[6497]^c[6447]^c[6641]^c[6658]^c[6827]^c[7153]^c[7151]^c[7182]^c[7475]^c[7626]^c[7500]^c[8009]^c[7692]^c[7718]^c[8409]^c[8175]^c[8420];
        //1st row
        d[t+1*Zc]=c[306]^c[307]^c[76]^c[205]^c[276]^c[402]^c[403]^c[634]^c[471]^c[817]^c[818]^c[844]^c[1096]^c[1520]^c[1521]^c[1225]^c[1152]^c[1824]^c[1868]^c[1811]^c[2100]^c[2101]^c[2064]^c[2176]^c[2519]^c[2520]^c[2465]^c[2503]^c[3019]^c[2955]^c[2841]^c[3403]^c[3232]^c[3128]^c[3772]^c[3773]^c[3634]^c[3519]^c[4127]^c[4128]^c[3969]^c[3972]^c[4332]^c[4333]^c[4519]^c[4529]^c[4624]^c[4625]^c[4950]^c[4839]^c[5348]^c[5349]^c[5192]^c[5333]^c[5593]^c[5464]^c[5588]^c[5974]^c[5975]^c[5859]^c[5813]^c[6249]^c[6250]^c[6498]^c[6448]^c[6642]^c[6659]^c[6828]^c[7153]^c[7154]^c[7152]^c[7183]^c[7475]^c[7476]^c[7627]^c[7501]^c[8009]^c[8010]^c[7693]^c[7719]^c[8409]^c[8410]^c[8176]^c[8421];
        //2nd row
        d[t+2*Zc]=c[307]^c[76]^c[204]^c[205]^c[275]^c[276]^c[403]^c[633]^c[634]^c[470]^c[471]^c[818]^c[844]^c[1095]^c[1096]^c[1521]^c[1225]^c[1535]^c[1152]^c[1824]^c[1867]^c[1868]^c[1810]^c[1811]^c[2101]^c[2064]^c[2175]^c[2176]^c[2520]^c[2464]^c[2465]^c[2502]^c[2503]^c[3019]^c[2954]^c[2955]^c[2840]^c[2841]^c[3403]^c[3231]^c[3232]^c[3127]^c[3128]^c[3773]^c[3634]^c[3518]^c[3519]^c[4128]^c[3968]^c[3969]^c[3971]^c[3972]^c[4333]^c[4519]^c[4528]^c[4529]^c[4625]^c[4950]^c[4838]^c[4839]^c[5349]^c[5191]^c[5192]^c[5332]^c[5333]^c[5593]^c[5463]^c[5464]^c[5587]^c[5588]^c[5975]^c[5859]^c[5812]^c[5813]^c[6250]^c[6498]^c[6447]^c[6448]^c[6642]^c[6658]^c[6659]^c[6827]^c[6828]^c[7154]^c[7151]^c[7152]^c[7182]^c[7183]^c[7476]^c[7627]^c[7500]^c[7501]^c[8010]^c[7692]^c[7693]^c[7718]^c[7719]^c[8410]^c[8176]^c[8420]^c[8421];
        //3rd row
        d[t+3*Zc]=c[307]^c[76]^c[205]^c[275]^c[276]^c[403]^c[634]^c[470]^c[471]^c[818]^c[844]^c[1096]^c[1521]^c[1225]^c[1535]^c[1152]^c[1824]^c[1868]^c[1810]^c[1811]^c[2101]^c[2064]^c[2176]^c[2520]^c[2465]^c[2502]^c[2503]^c[3019]^c[2955]^c[2840]^c[2841]^c[3403]^c[3232]^c[3127]^c[3128]^c[3773]^c[3634]^c[3519]^c[4128]^c[3969]^c[3971]^c[3972]^c[4333]^c[4519]^c[4528]^c[4529]^c[4625]^c[4950]^c[4838]^c[4839]^c[5349]^c[5192]^c[5332]^c[5333]^c[5593]^c[5464]^c[5587]^c[5588]^c[5975]^c[5859]^c[5813]^c[6250]^c[6498]^c[6447]^c[6448]^c[6642]^c[6659]^c[6827]^c[6828]^c[7154]^c[7152]^c[7182]^c[7183]^c[7476]^c[7627]^c[7501]^c[8010]^c[7693]^c[7718]^c[7719]^c[8410]^c[8176]^c[8420]^c[8421];
        //4th row
        d[t+4*Zc]=c[331]^c[564];
        //5th row
        d[t+5*Zc]=c[79]^c[232]^c[361]^c[48]^c[194]^c[559]^c[406]^c[627]^c[397]^c[974]^c[1000]^c[868]^c[1293]^c[1381]^c[1308]^c[1266]^c[1596]^c[1640]^c[1583]^c[2257]^c[2220]^c[1948]^c[2676]^c[2621]^c[2659]^c[2791]^c[2727]^c[2997]^c[3175]^c[3388]^c[3284]^c[3545]^c[3790]^c[3675]^c[3900]^c[4125]^c[4128]^c[4489]^c[4291]^c[4301]^c[4781]^c[4722]^c[4611]^c[4773]^c[5121]^c[5348]^c[5105]^c[5749]^c[5620]^c[5744]^c[6131]^c[6015]^c[5969]^c[6406]^c[6270]^c[6220]^c[6384]^c[6798]^c[6815]^c[6600]^c[6926]^c[6924]^c[6955]^c[7632]^c[7399]^c[7657]^c[7782]^c[7849]^c[7875]^c[8182]^c[8332]^c[8193]^c[8114];
        //6th row
        d[t+6*Zc]=c[277]^c[2560]^c[3840]^c[4574]^c[5083]^c[6780]^c[6929]^c[7904];
        //7th row
        d[t+7*Zc]=c[8]^c[445]^c[1851]^c[3020]^c[3361]^c[5489];
        //8th row
        d[t+8*Zc]=c[373]^c[93]^c[142]^c[246]^c[271]^c[374]^c[375]^c[342]^c[61]^c[62]^c[306]^c[469]^c[573]^c[700]^c[419]^c[420]^c[537]^c[640]^c[641]^c[562]^c[884]^c[988]^c[910]^c[1014]^c[778]^c[881]^c[882]^c[1203]^c[1307]^c[1291]^c[1395]^c[1218]^c[1321]^c[1322]^c[1316]^c[1890]^c[1610]^c[1550]^c[1653]^c[1654]^c[1877]^c[1596]^c[1597]^c[2167]^c[2271]^c[2130]^c[2234]^c[2242]^c[1961]^c[1962]^c[2586]^c[2306]^c[2531]^c[2634]^c[2635]^c[2569]^c[2672]^c[2673]^c[2701]^c[2805]^c[3021]^c[2740]^c[2741]^c[2907]^c[3010]^c[3011]^c[3085]^c[3189]^c[3298]^c[3401]^c[3402]^c[3194]^c[3297]^c[3298]^c[3839]^c[3559]^c[3700]^c[3804]^c[3585]^c[3688]^c[3689]^c[4194]^c[3914]^c[4035]^c[4138]^c[4139]^c[4038]^c[4141]^c[4142]^c[4399]^c[4503]^c[4585]^c[4305]^c[4595]^c[4314]^c[4315]^c[4691]^c[4795]^c[4632]^c[4736]^c[4905]^c[4624]^c[4625]^c[4625]^c[5031]^c[5135]^c[5258]^c[5361]^c[5362]^c[5015]^c[5118]^c[5119]^c[5659]^c[5379]^c[5530]^c[5633]^c[5634]^c[5654]^c[5757]^c[5758]^c[6041]^c[5761]^c[5925]^c[6029]^c[5879]^c[5982]^c[5983]^c[6316]^c[6420]^c[6180]^c[6284]^c[6514]^c[6233]^c[6234]^c[6182]^c[6708]^c[6812]^c[6725]^c[6828]^c[6829]^c[6894]^c[6613]^c[6614]^c[7220]^c[6940]^c[7218]^c[6937]^c[6938]^c[7249]^c[6968]^c[6969]^c[7542]^c[7646]^c[7309]^c[7413]^c[7567]^c[7670]^c[7671]^c[7519]^c[7692]^c[7796]^c[7759]^c[7862]^c[7863]^c[7785]^c[7888]^c[7889]^c[8092]^c[8196]^c[8242]^c[8346]^c[8103]^c[8206]^c[8207]^c[8431];
        //9th row
        d[t+9*Zc]=c[365]^c[615]^c[4160]^c[4356]^c[5048]^c[6830]^c[6974]^c[7761];
        //10th row
        d[t+10*Zc]=c[484]^c[1106]^c[1809]^c[2798]^c[3454]^c[5729];
        //11th row
        d[t+11*Zc]=c[256]^c[37]^c[38]^c[25]^c[191]^c[154]^c[320]^c[225]^c[7]^c[47]^c[736]^c[517]^c[518]^c[583]^c[749]^c[420]^c[586]^c[485]^c[1151]^c[932]^c[933]^c[793]^c[959]^c[1045]^c[827]^c[1470]^c[1251]^c[1252]^c[1174]^c[1340]^c[1485]^c[1267]^c[1773]^c[1555]^c[1817]^c[1599]^c[1760]^c[1542]^c[2050]^c[2215]^c[2216]^c[2013]^c[2179]^c[2125]^c[2291]^c[2469]^c[2634]^c[2635]^c[2414]^c[2580]^c[2452]^c[2618]^c[2968]^c[2750]^c[2904]^c[3070]^c[2790]^c[2956]^c[3352]^c[3134]^c[3181]^c[3347]^c[3077]^c[3243]^c[3722]^c[3503]^c[3504]^c[3583]^c[3749]^c[3468]^c[3634]^c[4077]^c[3858]^c[3859]^c[3918]^c[4084]^c[3921]^c[4087]^c[4282]^c[4447]^c[4448]^c[4468]^c[4250]^c[4478]^c[4260]^c[4958]^c[4739]^c[4740]^c[4899]^c[4681]^c[4788]^c[4954]^c[4615]^c[5298]^c[5079]^c[5080]^c[5141]^c[5307]^c[5282]^c[5064]^c[5542]^c[5708]^c[5413]^c[5579]^c[5537]^c[5703]^c[5924]^c[6089]^c[6090]^c[5808]^c[5974]^c[5762]^c[5928]^c[6199]^c[6364]^c[6365]^c[6447]^c[6229]^c[6397]^c[6179]^c[6190]^c[6591]^c[6757]^c[6608]^c[6774]^c[6777]^c[6559]^c[7103]^c[7268]^c[7269]^c[7101]^c[7267]^c[7132]^c[6914]^c[7425]^c[7590]^c[7591]^c[7576]^c[7358]^c[7450]^c[7616]^c[7959]^c[7740]^c[7741]^c[8026]^c[7808]^c[8052]^c[7834]^c[8359]^c[8140]^c[8141]^c[8125]^c[8291]^c[8370]^c[8152]^c[8251];
        //12th row
        d[t+12*Zc]=c[76]^c[569]^c[4013]^c[4455]^c[5041]^c[6985];
        //13th row
        d[t+13*Zc]=c[292]^c[293]^c[62]^c[191]^c[262]^c[312]^c[388]^c[389]^c[620]^c[457]^c[803]^c[804]^c[830]^c[1082]^c[1506]^c[1507]^c[1211]^c[1522]^c[1328]^c[1810]^c[1854]^c[1797]^c[2086]^c[2087]^c[2050]^c[2162]^c[2505]^c[2506]^c[2451]^c[2489]^c[3005]^c[2941]^c[2827]^c[2953]^c[3389]^c[3218]^c[3114]^c[3758]^c[3759]^c[3620]^c[3505]^c[4113]^c[4114]^c[3955]^c[3958]^c[4318]^c[4319]^c[4505]^c[4515]^c[4610]^c[4611]^c[4936]^c[4825]^c[5334]^c[5335]^c[5178]^c[5319]^c[5579]^c[5450]^c[5574]^c[5960]^c[5961]^c[5845]^c[5799]^c[6235]^c[6236]^c[6484]^c[6434]^c[6628]^c[6645]^c[6814]^c[7139]^c[7140]^c[7138]^c[7169]^c[7461]^c[7462]^c[7613]^c[7487]^c[7995]^c[7996]^c[8063]^c[7705]^c[7794]^c[8395]^c[8396]^c[8162]^c[8407];
        //14th row
        d[t+14*Zc]=c[141]^c[4855]^c[5896]^c[6232]^c[6874]^c[8075];
        //15th row
        d[t+15*Zc]=c[192]^c[345]^c[90]^c[160]^c[161]^c[240]^c[672]^c[519]^c[739]^c[740]^c[385]^c[1087]^c[1113]^c[981]^c[1406]^c[1494]^c[1420]^c[1421]^c[1709]^c[1753]^c[1695]^c[1696]^c[1986]^c[1949]^c[2061]^c[2405]^c[2350]^c[2387]^c[2388]^c[2904]^c[2840]^c[2725]^c[2726]^c[3288]^c[3117]^c[3396]^c[3397]^c[3658]^c[3519]^c[3788]^c[4013]^c[3854]^c[3856]^c[3857]^c[4049]^c[4602]^c[4404]^c[4413]^c[4414]^c[4894]^c[4835]^c[4723]^c[4724]^c[5234]^c[5077]^c[5217]^c[5218]^c[5309]^c[5478]^c[5733]^c[5472]^c[5473]^c[5860]^c[6128]^c[6082]^c[6519]^c[6383]^c[6332]^c[6333]^c[6911]^c[6544]^c[6712]^c[6713]^c[7039]^c[7037]^c[7067]^c[7068]^c[6966]^c[7361]^c[7512]^c[7386]^c[7895]^c[7962]^c[7987]^c[7988]^c[8295]^c[8445]^c[8305]^c[8306];
        //16th row
        d[t+16*Zc]=c[363]^c[132]^c[261]^c[332]^c[459]^c[690]^c[527]^c[396]^c[874]^c[900]^c[768]^c[1193]^c[1281]^c[1208]^c[1489]^c[1880]^c[1540]^c[1867]^c[2157]^c[2120]^c[2232]^c[2576]^c[2521]^c[2559]^c[2691]^c[3011]^c[2897]^c[3075]^c[3288]^c[3184]^c[3829]^c[3690]^c[3575]^c[4184]^c[4025]^c[4028]^c[4389]^c[4575]^c[4585]^c[4280]^c[4681]^c[4622]^c[4895]^c[5021]^c[5248]^c[5005]^c[5649]^c[5520]^c[5644]^c[6031]^c[5915]^c[5869]^c[6306]^c[6170]^c[6504]^c[6698]^c[6715]^c[6884]^c[7210]^c[7208]^c[7239]^c[7532]^c[7299]^c[7557]^c[7682]^c[7749]^c[7775]^c[7968]^c[8082]^c[8232]^c[8093];
        //17th row
        d[t+17*Zc]=c[259]^c[5678]^c[6224]^c[6885]^c[8438];
        //18th row
        d[t+18*Zc]=c[513]^c[4770]^c[5271]^c[7043]^c[7299];
        //19th row
        d[t+19*Zc]=c[144]^c[596]^c[3031]^c[3313]^c[4036];
        //20th row
        d[t+20*Zc]=c[365]^c[134]^c[263]^c[334]^c[186]^c[461]^c[692]^c[529]^c[876]^c[902]^c[770]^c[1195]^c[1283]^c[1210]^c[1357]^c[1882]^c[1542]^c[1869]^c[2159]^c[2122]^c[2234]^c[2578]^c[2523]^c[2561]^c[2693]^c[3013]^c[2899]^c[3077]^c[3290]^c[3186]^c[3831]^c[3692]^c[3577]^c[3719]^c[4186]^c[4027]^c[4030]^c[4391]^c[4577]^c[4587]^c[4564]^c[4683]^c[4624]^c[4897]^c[5023]^c[5250]^c[5007]^c[5651]^c[5522]^c[5646]^c[6033]^c[5917]^c[5871]^c[6308]^c[6172]^c[6506]^c[6700]^c[6717]^c[6886]^c[7212]^c[7210]^c[7241]^c[7534]^c[7301]^c[7559]^c[7684]^c[7751]^c[7777]^c[8084]^c[8234]^c[8095];
        //21st row
        d[t+21*Zc]=c[588]^c[2021]^c[6471]^c[7892]^c[8160];
        //22nd row
        d[t+22*Zc]=c[29]^c[4618]^c[5224]^c[6549];
        //23rd row
        d[t+23*Zc]=c[407]^c[856]^c[3900]^c[6938];
        //24th row
        d[t+24*Zc]=c[156]^c[309]^c[54]^c[125]^c[297]^c[636]^c[483]^c[704]^c[1051]^c[1077]^c[945]^c[1370]^c[1458]^c[1385]^c[1309]^c[1673]^c[1717]^c[1660]^c[1770]^c[1950]^c[2297]^c[2025]^c[2369]^c[2314]^c[2352]^c[2868]^c[2804]^c[2690]^c[3252]^c[3081]^c[3361]^c[3622]^c[3483]^c[3752]^c[3977]^c[4202]^c[4205]^c[4566]^c[4368]^c[4378]^c[4562]^c[4858]^c[4799]^c[4688]^c[5198]^c[5041]^c[5182]^c[5442]^c[5697]^c[5437]^c[5824]^c[6092]^c[6046]^c[6483]^c[6347]^c[6297]^c[6875]^c[6892]^c[6677]^c[7003]^c[7001]^c[7032]^c[7325]^c[7476]^c[7350]^c[7859]^c[7926]^c[7952]^c[8259]^c[8409]^c[8270];
        //25th row
        d[t+25*Zc]=c[455]^c[2320]^c[3070]^c[5687];
        //26th row
        d[t+26*Zc]=c[70]^c[848]^c[1611]^c[5895];
        //27th row
        d[t+27*Zc]=c[577]^c[2497]^c[3172];
        //28th row
        d[t+28*Zc]=c[221]^c[1554]^c[7539]^c[8337];
        //29th row
        d[t+29*Zc]=c[1]^c[154]^c[283]^c[353]^c[354]^c[481]^c[712]^c[548]^c[549]^c[635]^c[896]^c[922]^c[790]^c[1215]^c[1303]^c[1229]^c[1230]^c[1902]^c[1562]^c[1888]^c[1889]^c[2179]^c[2142]^c[2254]^c[2598]^c[2543]^c[2580]^c[2581]^c[2713]^c[3033]^c[2918]^c[2919]^c[3097]^c[3310]^c[3205]^c[3206]^c[3467]^c[3712]^c[3597]^c[4206]^c[4047]^c[4049]^c[4050]^c[4411]^c[4597]^c[4606]^c[4607]^c[4703]^c[4644]^c[4916]^c[4917]^c[5043]^c[5270]^c[5026]^c[5027]^c[5671]^c[5542]^c[5665]^c[5666]^c[5380]^c[6053]^c[5937]^c[5891]^c[6328]^c[6192]^c[6525]^c[6526]^c[6720]^c[6737]^c[6905]^c[6906]^c[7232]^c[7230]^c[7260]^c[7261]^c[7058]^c[7554]^c[7321]^c[7579]^c[7704]^c[7771]^c[7796]^c[7797]^c[8104]^c[8254]^c[8114]^c[8115];
        //30th row
        d[t+30*Zc]=c[13]^c[166]^c[294]^c[295]^c[365]^c[366]^c[158]^c[493]^c[723]^c[724]^c[560]^c[561]^c[908]^c[934]^c[801]^c[802]^c[1227]^c[1315]^c[1241]^c[1242]^c[1914]^c[1573]^c[1574]^c[1900]^c[1901]^c[2191]^c[2154]^c[2265]^c[2266]^c[2610]^c[2554]^c[2555]^c[2592]^c[2593]^c[2725]^c[3044]^c[3045]^c[2930]^c[2931]^c[3109]^c[3321]^c[3322]^c[3217]^c[3218]^c[3479]^c[3724]^c[3608]^c[3609]^c[4218]^c[4058]^c[4059]^c[4061]^c[4062]^c[4068]^c[4423]^c[4225]^c[4234]^c[4235]^c[4715]^c[4656]^c[4928]^c[4929]^c[5055]^c[5281]^c[5282]^c[5038]^c[5039]^c[5251]^c[5683]^c[5553]^c[5554]^c[5677]^c[5678]^c[6065]^c[5949]^c[5902]^c[5903]^c[6340]^c[6204]^c[6153]^c[6154]^c[6732]^c[6748]^c[6749]^c[6533]^c[6534]^c[7244]^c[7241]^c[7242]^c[7272]^c[7273]^c[7566]^c[7333]^c[7590]^c[7591]^c[7716]^c[7782]^c[7783]^c[7808]^c[7809]^c[8116]^c[8266]^c[8126]^c[8127];
        //31st row
        d[t+31*Zc]=c[180]^c[179]^c[333]^c[332]^c[78]^c[77]^c[149]^c[147]^c[148]^c[660]^c[659]^c[507]^c[506]^c[728]^c[726]^c[727]^c[483]^c[1075]^c[1074]^c[1101]^c[1100]^c[969]^c[968]^c[1394]^c[1393]^c[1482]^c[1481]^c[1409]^c[1407]^c[1408]^c[1697]^c[1696]^c[1741]^c[1740]^c[1684]^c[1682]^c[1683]^c[1974]^c[1973]^c[1937]^c[1936]^c[2049]^c[2048]^c[2393]^c[2392]^c[2338]^c[2337]^c[2376]^c[2374]^c[2375]^c[2892]^c[2891]^c[2828]^c[2827]^c[2714]^c[2712]^c[2713]^c[2902]^c[3276]^c[3275]^c[3105]^c[3104]^c[3385]^c[3383]^c[3384]^c[3646]^c[3645]^c[3507]^c[3506]^c[3776]^c[3775]^c[4001]^c[4000]^c[3842]^c[3841]^c[3845]^c[3843]^c[3844]^c[4590]^c[4589]^c[4392]^c[4391]^c[4402]^c[4400]^c[4401]^c[4882]^c[4881]^c[4823]^c[4822]^c[4712]^c[4710]^c[4711]^c[5222]^c[5221]^c[5065]^c[5064]^c[5206]^c[5204]^c[5205]^c[5466]^c[5465]^c[5721]^c[5720]^c[5461]^c[5459]^c[5460]^c[5848]^c[5847]^c[6116]^c[6115]^c[6070]^c[6069]^c[6507]^c[6506]^c[6371]^c[6370]^c[6321]^c[6319]^c[6320]^c[6899]^c[6898]^c[6532]^c[6531]^c[6701]^c[6699]^c[6700]^c[7027]^c[7026]^c[7025]^c[7024]^c[7056]^c[7054]^c[7055]^c[7349]^c[7348]^c[7500]^c[7499]^c[7374]^c[7373]^c[7883]^c[7882]^c[7950]^c[7949]^c[7976]^c[7974]^c[7975]^c[8283]^c[8282]^c[8433]^c[8432]^c[8294]^c[8292]^c[8293];
        //32nd row
        d[t+32*Zc]=c[210]^c[363]^c[107]^c[108]^c[178]^c[179]^c[101]^c[690]^c[536]^c[537]^c[757]^c[758]^c[1105]^c[1131]^c[998]^c[999]^c[1424]^c[1512]^c[1438]^c[1439]^c[1727]^c[1770]^c[1771]^c[1713]^c[1714]^c[2004]^c[1967]^c[2078]^c[2079]^c[2423]^c[2367]^c[2368]^c[2405]^c[2406]^c[2922]^c[2857]^c[2858]^c[2743]^c[2744]^c[3306]^c[3134]^c[3135]^c[3414]^c[3415]^c[3676]^c[3537]^c[3805]^c[3806]^c[4031]^c[3871]^c[3872]^c[3874]^c[3875]^c[4236]^c[4422]^c[4431]^c[4432]^c[4912]^c[4853]^c[4741]^c[4742]^c[4808]^c[5252]^c[5094]^c[5095]^c[5235]^c[5236]^c[5496]^c[5750]^c[5751]^c[5490]^c[5491]^c[5550]^c[5878]^c[5762]^c[6099]^c[6100]^c[6153]^c[6401]^c[6350]^c[6351]^c[6545]^c[6561]^c[6562]^c[6730]^c[6731]^c[7057]^c[7054]^c[7055]^c[7085]^c[7086]^c[7379]^c[7530]^c[7403]^c[7404]^c[7913]^c[7979]^c[7980]^c[8005]^c[8006]^c[8313]^c[8079]^c[8323]^c[8324];
        //33rd row
        d[t+33*Zc]=c[706]^c[775]^c[4584]^c[8168];
        //34th row
        d[t+34*Zc]=c[229]^c[2835]^c[5961]^c[6839];
        //35th row
        d[t+35*Zc]=c[188]^c[341]^c[86]^c[157]^c[668]^c[515]^c[736]^c[703]^c[1083]^c[1109]^c[977]^c[1402]^c[1490]^c[1417]^c[1705]^c[1749]^c[1692]^c[1982]^c[1945]^c[2057]^c[2401]^c[2346]^c[2384]^c[2638]^c[2900]^c[2836]^c[2722]^c[3284]^c[3113]^c[3393]^c[3654]^c[3515]^c[3784]^c[4009]^c[3850]^c[3853]^c[4598]^c[4400]^c[4410]^c[4890]^c[4831]^c[4720]^c[4609]^c[5230]^c[5073]^c[5214]^c[5474]^c[5729]^c[5469]^c[5856]^c[6124]^c[6078]^c[6515]^c[6379]^c[6329]^c[6907]^c[6540]^c[6709]^c[7035]^c[7033]^c[7064]^c[7357]^c[7508]^c[7382]^c[7891]^c[7958]^c[7984]^c[8291]^c[8441]^c[8302];
        //36th row
        d[t+36*Zc]=c[209]^c[5688]^c[6056]^c[6932];
        //37th row
        d[t+37*Zc]=c[37]^c[38]^c[191]^c[320]^c[7]^c[517]^c[518]^c[749]^c[586]^c[652]^c[932]^c[933]^c[959]^c[827]^c[1251]^c[1252]^c[1340]^c[1267]^c[1555]^c[1599]^c[1542]^c[2215]^c[2216]^c[2179]^c[2291]^c[2634]^c[2635]^c[2580]^c[2618]^c[2750]^c[3070]^c[2956]^c[3134]^c[3347]^c[3243]^c[3503]^c[3504]^c[3749]^c[3634]^c[3858]^c[3859]^c[4084]^c[4087]^c[4447]^c[4448]^c[4250]^c[4260]^c[4739]^c[4740]^c[4681]^c[4954]^c[5079]^c[5080]^c[5307]^c[5064]^c[5073]^c[5708]^c[5579]^c[5703]^c[6089]^c[6090]^c[5974]^c[5928]^c[6364]^c[6365]^c[6229]^c[6179]^c[6757]^c[6774]^c[6559]^c[7268]^c[7269]^c[7267]^c[6914]^c[7590]^c[7591]^c[7358]^c[7616]^c[7740]^c[7741]^c[7808]^c[7834]^c[8140]^c[8141]^c[8291]^c[8152];
        //38th row
        d[t+38*Zc]=c[184]^c[3632]^c[4128]^c[4821];
        //39th row
        d[t+39*Zc]=c[641]^c[1244]^c[3033]^c[7592];
        //40th row
        d[t+40*Zc]=c[174]^c[3108]^c[6839];
        //41st row
        d[t+41*Zc]=c[435]^c[1465]^c[3594]^c[7199];
        //42nd row
        d[t+42*Zc]=c[141]^c[294]^c[38]^c[39]^c[109]^c[110]^c[112]^c[621]^c[467]^c[468]^c[688]^c[689]^c[1036]^c[1062]^c[929]^c[930]^c[1355]^c[1443]^c[1369]^c[1370]^c[1658]^c[1701]^c[1702]^c[1644]^c[1645]^c[1549]^c[1935]^c[2282]^c[2009]^c[2010]^c[2354]^c[2682]^c[2683]^c[2336]^c[2337]^c[2853]^c[2788]^c[2789]^c[3058]^c[3059]^c[3237]^c[3449]^c[3450]^c[3345]^c[3346]^c[3607]^c[3468]^c[3736]^c[3737]^c[3962]^c[4186]^c[4187]^c[4189]^c[4190]^c[4551]^c[4353]^c[4362]^c[4363]^c[4843]^c[4784]^c[4672]^c[4673]^c[5183]^c[5025]^c[5026]^c[5166]^c[5167]^c[5427]^c[5681]^c[5682]^c[5421]^c[5422]^c[5809]^c[6077]^c[6030]^c[6031]^c[6468]^c[6332]^c[6281]^c[6282]^c[6860]^c[6876]^c[6877]^c[6661]^c[6662]^c[6988]^c[6985]^c[6986]^c[7016]^c[7017]^c[7310]^c[7461]^c[7334]^c[7335]^c[7844]^c[7910]^c[7911]^c[7936]^c[7937]^c[8244]^c[8394]^c[8254]^c[8255];
        //43rd row
        d[t+43*Zc]=c[91]^c[244]^c[373]^c[59]^c[60]^c[571]^c[418]^c[638]^c[639]^c[496]^c[986]^c[1012]^c[880]^c[1305]^c[1393]^c[1319]^c[1320]^c[1608]^c[1652]^c[1594]^c[1595]^c[2269]^c[2232]^c[1960]^c[2304]^c[2633]^c[2670]^c[2671]^c[2803]^c[2739]^c[3008]^c[3009]^c[3187]^c[3400]^c[3295]^c[3296]^c[3557]^c[3802]^c[3687]^c[3912]^c[4137]^c[4139]^c[4140]^c[4501]^c[4303]^c[4312]^c[4313]^c[4793]^c[4734]^c[4622]^c[4623]^c[5133]^c[5360]^c[5116]^c[5117]^c[5377]^c[5632]^c[5755]^c[5756]^c[6143]^c[6027]^c[5981]^c[6418]^c[6282]^c[6231]^c[6232]^c[6275]^c[6810]^c[6827]^c[6611]^c[6612]^c[6938]^c[6936]^c[6966]^c[6967]^c[7025]^c[7644]^c[7411]^c[7669]^c[7794]^c[7861]^c[7886]^c[7887]^c[8194]^c[8344]^c[8204]^c[8205];
        //44th row
        d[t+44*Zc]=c[196]^c[349]^c[94]^c[165]^c[79]^c[676]^c[523]^c[744]^c[1091]^c[1117]^c[985]^c[1410]^c[1498]^c[1425]^c[1713]^c[1757]^c[1700]^c[1990]^c[1953]^c[2065]^c[2409]^c[2354]^c[2392]^c[2908]^c[2844]^c[2730]^c[2765]^c[3292]^c[3121]^c[3401]^c[3662]^c[3523]^c[3792]^c[3618]^c[4017]^c[3858]^c[3861]^c[4606]^c[4408]^c[4418]^c[4898]^c[4839]^c[4728]^c[5238]^c[5081]^c[5222]^c[5482]^c[5737]^c[5477]^c[5864]^c[6132]^c[6086]^c[6523]^c[6387]^c[6337]^c[6531]^c[6548]^c[6717]^c[7043]^c[7041]^c[7072]^c[7365]^c[7516]^c[7390]^c[7899]^c[7966]^c[7992]^c[8299]^c[8065]^c[8310];
        //45th row
        d[t+45*Zc]=c[518]^c[2452]^c[3854];
      }
    }
    else {
      printf("lifting size Zc %d not optimized\n",Zc);
      return(-1);
    }
  }
  else {
    printf("BG %d not optimized\n",BG);
    return(-1);
  }

  // information part and puncture columns
  memcpy(&channel_input[0], &c[2*Zc], (block_length-2*Zc)*sizeof(unsigned char));
  memcpy(&channel_input[block_length-2*Zc], &d[Kb*Zc], ((nrows-no_punctured_columns) * Zc-removed_bit)*sizeof(unsigned char));
  //memcpy(channel_input,c,Kb*Zc*sizeof(unsigned char));
  return 0;
}

int ldpc_encoder_orig(unsigned char *test_input,unsigned char *channel_input,short block_length,double rate)
{
  unsigned char c[22*384]; //padded input, unpacked, max size
  unsigned char d[68*384]; //coded output, unpacked, max size
  unsigned char channel_temp,temp;
  short *Gen_shift_values, *no_shift_values, *pointer_shift_values;
  short BG,Zc,Kb,nrows,ncols;
  int i,i1,i2,i3,i4,i5,t,t1,temp_prime;
  int no_punctured_columns,removed_bit;
  //Table of possible lifting sizes
  short lift_size[51]= {2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,20,22,24,26,28,30,32,36,40,44,48,52,56,60,64,72,80,88,96,104,112,120,128,144,160,176,192,208,224,240,256,288,320,352,384};
  //determine number of bits in codeword
  //if (block_length>3840)
  //  {
  BG=1;
  Kb = 22;
  nrows=46; //parity check bits
  ncols=22; //info bits
  /*  }
  else if (block_length<=3840)
    {
    BG=2;
    nrows=42;  //parity check bits
    ncols=10;  // info bits
    if (block_length>640)
    Kb = 10;
    else if (block_length>560)
    Kb = 9;
    else if (block_length>192)
    Kb = 8;
    else
    Kb = 6;
    }*/

  //find minimum value in all sets of lifting size
  Zc=0;
  for (i1=0; i1 < 51; i1++)
  {
    if (lift_size[i1] >= (double) block_length/Kb)
    {
      Zc = lift_size[i1];
      //printf("%d\n",Zc);
      break;
    }
  }
  if (Zc==0) {
    printf("ldpc_encoder: no lift_size found, problem in block_length %d\n",block_length);
    return(-1);
  }

  // load base graph of generator matrix
  if (BG==1)
  {
    no_shift_values=(short *) no_shift_values_BG1;
    pointer_shift_values=(short *) pointer_shift_values_BG1;
  }
  else if (BG==2)
  {
    no_shift_values=(short *) no_shift_values_BG2;
    pointer_shift_values=(short *) pointer_shift_values_BG2;
  }

  Gen_shift_values=choose_generator_matrix(BG,Zc);
  no_punctured_columns=(int)((nrows+Kb-2)*Zc-block_length/rate)/Zc;
  removed_bit=(Kb+nrows-no_punctured_columns-2) * Zc-(int)(block_length/rate);
  //printf("%d\n",no_punctured_columns);
  //output_length = (Kb+nrows-no_punctured_columns) * Zc;
  // unpack input
  memset(c,0,sizeof(unsigned char) * Kb * Zc);

  for (i=0; i<block_length; i++)
  {
    //c[i] = test_input[i/8]<<(i%8);
    //c[i]=c[i]>>7&1;
    c[i]=(test_input[i/8]&(1<<(i&7)))>>(i&7);
  }

  // parity check part
  for (i2=0; i2 < Zc; i2++)
  {
    t=Kb*Zc+i2;

    //rotate matrix here
    for (i5=0; i5 < Kb; i5++)
    {
      temp = c[i5*Zc];
      memmove(&c[i5*Zc], &c[i5*Zc+1], (Zc-1)*sizeof(unsigned char));
      c[i5*Zc+Zc-1] = temp;
    }

    // calculate each row in base graph
    for (i1=0; i1 < nrows-no_punctured_columns; i1++)
    {
      channel_temp=0;

      for (i3=0; i3 < Kb; i3++)
      {
        temp_prime=i1 * ncols + i3;

        for (i4=0; i4 < no_shift_values[temp_prime]; i4++)
        {
          channel_temp = channel_temp ^ c[ i3*Zc + Gen_shift_values[ pointer_shift_values[temp_prime]+i4 ] ];
        }
      }

      d[t+i1*Zc]=channel_temp;
      //channel_input[t+i1*Zc]=channel_temp;
    }
  }

  // information part
  memcpy(d,c,Kb*Zc*sizeof(unsigned char));

  // puncture columns
  for (i = 2*Zc,t1=0; i < (Kb+nrows-no_punctured_columns) * Zc-removed_bit; i++)
  {
    channel_input[t1]=d[i];
    t1++;
  }

  //memcpy(channel_input,c,Kb*Zc*sizeof(unsigned char));
  /*
      //pack into output
      memset(channel_input,0,output_length/8*sizeof(unsigned char));
      for (i=0;i<output_length;i++)
        {
  //printf("[%d]=%d\n",i,d[i]);
            d[i]=d[i] << 7;
                        channel_input[i/8] = channel_input[i/8] | (d[i] >> (i%8));
        }
  */
  return 0;
}
